From 67415b36f94a33d4bcf71cd8e48025617faa13fe Mon Sep 17 00:00:00 2001
From: Terrence Pu <terrence.pu@amlogic.com>
Date: Sun, 21 Jun 2020 12:30:54 -0700
Subject: [PATCH] RDK: Fixed the undefined symbol issues with latest RDK update

PD#SWPL-27481

Problem:
After GCC 4.6 the -Wl,--as-need is by default but not all libraries
are ready in rootfs during multi-core compiling without gold-linker

Solution:
Add new option --Wl,--no-as-need in front of dynamic linked libraries

Verify:
u212

Change-Id: I382e34bf8b014228b3ab38d615a65a38141b1480
---
 Makefile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Makefile b/Makefile
index 7851c34..7b3f27b 100644
--- a/Makefile
+++ b/Makefile
@@ -24,7 +24,7 @@ GRPC_CPP_PLUGIN_PATH=$(HOST_DIR)/bin/grpc_cpp_plugin
 
 CFLAGS+=-fPIC -O2 -I$(PROTOC_INC) -I./include -I. -I./src
 CXXFLAGS+=-std=c++14
-LDFLAGS+=-lgrpc++_unsecure -lprotobuf -lboost_system -llog -ldl -lrt -lpthread -lstdc++
+LDFLAGS+=-Wl,--no-as-needed -lgrpc++_unsecure -lprotobuf -lboost_system -llog -ldl -lrt -lpthread -lstdc++
 
 %.grpc.pb.cc: %.proto
 	$(PROTOC) -I=. -I=$(PROTOC_INC) --grpc_out=. --plugin=protoc-gen-grpc=$(GRPC_CPP_PLUGIN_PATH) $<
-- 
2.17.1

