From fa2ba996bbd163b1380b35728de753a6b3a57556 Mon Sep 17 00:00:00 2001
From: "yi.liu" <yi.liu@amlogic.com>
Date: Mon, 10 Jul 2023 15:28:34 +0800
Subject: [PATCH 01/10] amlbian: T7b and T7c use same config [1/1]

PD#SWPL-131302

Problem:
T7b and T7c use same config.

Solution:
T7b and T7c use same config.

Verify:
local

Signed-off-by: yi.liu <yi.liu@amlogic.com>
Change-Id: I0dd717b944053c2856ec5c071e921e274b40f984
---
 conf/machine/mesont7-an400-debian-5.15.conf  |   3 +
 conf/machine/mesont7c-an400-debian-5.15.conf | 100 -------------------
 2 files changed, 3 insertions(+), 100 deletions(-)
 delete mode 100644 conf/machine/mesont7c-an400-debian-5.15.conf

diff --git a/conf/machine/mesont7-an400-debian-5.15.conf b/conf/machine/mesont7-an400-debian-5.15.conf
index a040261b..9289d4df 100644
--- a/conf/machine/mesont7-an400-debian-5.15.conf
+++ b/conf/machine/mesont7-an400-debian-5.15.conf
@@ -85,6 +85,9 @@ DISTRO_FEATURES_append = " gst-plugin-nn"
 DISTRO_FEATURES_append = " detect-library"
 DISTRO_FEATURES_append = " gst-plugin-conv"
 DISTRO_FEATURES_append = " mediactrlsrc"
+DISTRO_FEATURES_append = " mediactrlsrc-cam"
+DISTRO_FEATURES_append = " mediactrlsrc-hdmi"
+
 OVERRIDES .= ":an400:t7:onepass"
 MACHINEOVERRIDES .= ":client"
 
diff --git a/conf/machine/mesont7c-an400-debian-5.15.conf b/conf/machine/mesont7c-an400-debian-5.15.conf
deleted file mode 100644
index 55e9d292..00000000
--- a/conf/machine/mesont7c-an400-debian-5.15.conf
+++ /dev/null
@@ -1,100 +0,0 @@
-#@TYPE: Machine
-#@NAME: meson
-
-#@DESCRIPTION: Machine configuration for meson systems
-
-include conf/machine/include/mesont7c_k5.15_64b.inc
-include conf/machine/include/amlogic_weston.inc
-
-PREFERRED_PROVIDER_virtual/mesa = "libgles-eabihf-gondul-wayland-drm"
-PREFERRED_PROVIDER_virtual/mesa-gl = "libgles-eabihf-gondul-wayland-drm"
-PREFERRED_PROVIDER_virtual/libgbm = "libgles-eabihf-gondul-wayland-drm"
-PREFERRED_PROVIDER_virtual/egl = "libgles-eabihf-gondul-wayland-drm"
-PREFERRED_PROVIDER_virtual/libgl = "libgles-eabihf-gondul-wayland-drm"
-PREFERRED_PROVIDER_virtual/libgles1 = "libgles-eabihf-gondul-wayland-drm"
-PREFERRED_PROVIDER_virtual/libgles2 = "libgles-eabihf-gondul-wayland-drm"
-
-MACHINE_ESSENTIAL_EXTRA_RRECOMMENDS += " \
-        gpu \
-        wififw-ap6398 \
-        ap6xxx \
-        adla \
-        "
-
-RDEPENDS_packagegroup-amlogic-baserootfs_remove = " aml-subtitleserver"
-RDEPENDS_packagegroup-amlogic-baserootfs_remove = " gst-aml-drm-plugins"
-RDEPENDS_packagegroup-amlogic-baserootfs_remove = " fuse-exfat"
-RDEPENDS_packagegroup-amlogic-baserootfs_append = " isp isp-dev"
-RDEPENDS_packagegroup-amlogic-baserootfs_append = " cve libcve"
-RDEPENDS_packagegroup-amlogic-baserootfs_append = " npu-common"
-
-
-PREFERRED_VERSION_isp = "5.15"
-PREFERRED_VERSION_ap6xxx = "5.15"
-CHIPSET_NAME = "A311D2"
-KERNEL_DEVICETREE = "t7c_a311d2_an400_debian.dtb"
-UBOOT_MACHINE = "t7_an400_lpddr4x_debian_config"
-KERNEL_MODULE_AUTOLOAD += " dhd"
-KERNEL_MODULE_PROBECONF += "dhd"
-module_conf_dhd = "options dhd firmware_path=../../../etc/wifi/6398/ nvram_path=../../../etc/wifi/6398/"
-KERNEL_MODULE_AUTOLOAD += " snd-soc-dummy_codec"
-KERNEL_MODULE_AUTOLOAD += " snd-soc-aml_t9015"
-KERNEL_MODULE_AUTOLOAD += " snd-soc-tas5707"
-KERNEL_MODULE_AUTOLOAD += " snd-soc-aml_codec_tl1_acodec"
-KERNEL_MODULE_AUTOLOAD += " meson_ir"
-KERNEL_MODULE_AUTOLOAD += " hci_uart"
-KERNEL_MODULE_PROBECONF += "hci_uart"
-KERNEL_MODULE_AUTOLOAD += "meson-cpufreq"
-
-DISTRO_FEATURES_append = " amlbian"
-DISTRO_FEATURES_append = " drm"
-DISTRO_FEATURES_append = " gpt-partition"
-DISTRO_FEATURES_append = " kernel_515"
-
-#DISTRO_FEATURES_append = " onepass"
-DISTRO_FEATURES_append = " secure-u-boot optee "
-#DISTRO_FEATURES_append = " widevine "
-#DISTRO_FEATURES_remove = " alsa "
-DISTRO_FEATURES_append = " alsa "
-DISTRO_FEATURES_append = " pam"
-DISTRO_FEATURES_BACKFILL_CONSIDERED = "sysvinit"
-DEFAULT_DISTRO_FEATURES += " systemd"
-DISTRO_FEATURES_append = " systemd"
-DISTRO_FEATURES_remove = " sysvinit"
-DISTRO_FEATURES_append = " gstreamer1"
-DISTRO_FEATURES_append = " aml-dtv "
-DISTRO_FEATURES_append = " gst-plugin-venc"
-DISTRO_FEATURES_append = " aml-libjpeg"
-DISTRO_FEATURES_append = " aml-libmultienc"
-#DISTRO_FEATURES_append = " playready "
-DISTRO_FEATURES_append = " aml-isp"
-DISTRO_FEATURES_append = " amlogic-tv "
-DISTRO_FEATURES_append = " softap"
-DISTRO_FEATURES_append = " aml-libgdc"
-#DISTRO_FEATURES_append = " swupdate"
-#DISTRO_FEATURES_append = " recovery"
-EXTRA_IMAGEDEPENDS_remove = "u-boot"
-DISTRO_FEATURES_remove = "u-boot"
-
-DISTRO_FEATURES_append = " gst-aml-imgproc"
-DISTRO_FEATURES_append = " gst-aml-gfx2d"
-DISTRO_FEATURES_append = " gst-aml-ion-allocator"
-DISTRO_FEATURES_append = " gst-jpeg-swdec"
-
-DISTRO_FEATURES_append = " gst-plugin-overlay"
-DISTRO_FEATURES_append = " gst-plugin-nn"
-DISTRO_FEATURES_append = " detect-library"
-DISTRO_FEATURES_append = " gst-plugin-conv"
-DISTRO_FEATURES_append = " mediactrlsrc"
-DISTRO_FEATURES_append = " mediactrlsrc-cam"
-DISTRO_FEATURES_append = " mediactrlsrc-hdmi"
-
-OVERRIDES .= ":an400:t7:onepass"
-MACHINEOVERRIDES .= ":client"
-
-EXTRA_BLUETOOTH_STUFF := "${@bb.utils.contains('DISTRO_FEATURES', 'bluetooth', bb.utils.contains('DISTRO_FEATURES', 'bluez5', ' bluez5', ' bluez4', d), '', d)}"
-EXTRA_BLUETOOTH_STUFF += " bluez-alsa"
-EXTRA_BLUETOOTH_STUFF += " brcm-patchram-plus"
-DISTRO_FEATURES_append = "${EXTRA_BLUETOOTH_STUFF}"
-
-LINUX_VERSION_EXTENSION ?= ""
-- 
2.25.1

