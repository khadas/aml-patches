From 5964596b4819f308a29a2699f79332635d280fa5 Mon Sep 17 00:00:00 2001
From: Blance Tang <guofeng.tang@amlogic.com>
Date: Wed, 27 May 2020 15:13:33 +0800
Subject: [PATCH] RDK: remove libplayer depends [1/1]

PD#SWPL-

Problem:

Solution:

Verify:
  Local

Signed-off-by: Blance Tang <guofeng.tang@amlogic.com>
Change-Id: I11a02dd44024de4994652a9ef7738d6bf935bc76
---
 power/Makefile.am  |  3 ---
 power/plat-power.c | 27 ++++++++++++++++++++++++++-
 2 files changed, 26 insertions(+), 4 deletions(-)

diff --git a/power/Makefile.am b/power/Makefile.am
index 2ac48e9..3e0837b 100644
--- a/power/Makefile.am
+++ b/power/Makefile.am
@@ -1,10 +1,7 @@
 lib_LTLIBRARIES = libiarmmgrs-power-hal.la
 
-AM_LDFLAGS = -lamavutils
 libiarmmgrs_power_hal_la_SOURCES=plat-power.c
 
 libiarmmgrs_power_hal_la_CFLAGS=$(IARMMGRS_HAL_POWER_CFLAGS)
 libiarmmgrs_power_hal_la_LIBADD=$(IARMMGRS_HAL_POWER_LIBS)
 
-libiarmmgrs_power_hal_la_LDFLAGS = -lamavutils
-
diff --git a/power/plat-power.c b/power/plat-power.c
index b8e8c7f..a1c40bf 100644
--- a/power/plat-power.c
+++ b/power/plat-power.c
@@ -1,11 +1,36 @@
 #include <stdio.h>
 #include <stdlib.h>
+#include <fcntl.h>
+#include <errno.h>
+#include <strings.h>
+
 #include "plat_power.h"
-#include "Amsysfsutils.h"
 
 #define FILE_NAME_SIZE   64
 #define SIZE 10
 
+
+static int amsysfs_set_sysfs_str(const char *path, const char *val)
+{
+    int fd;
+    int bytes;
+    fd = open(path, O_CREAT | O_RDWR | O_TRUNC, 0644);
+    if (fd >= 0) {
+        bytes = write(fd, val, strlen(val));
+        close(fd);
+        return 0;
+
+    } else {
+        LOGE("unable to open file %s,err: %s\n", path, strerror(errno));
+
+    }
+    return -1;
+
+}
+
+
+
+
 static IARM_Bus_PWRMgr_PowerState_t power_state;
 
 /**
-- 
2.17.1

