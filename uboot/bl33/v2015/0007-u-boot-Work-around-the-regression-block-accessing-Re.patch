From 1ede559a83ffb39644842515e3572dd3957085ae Mon Sep 17 00:00:00 2001
From: Terrence Pu <terrence.pu@amlogic.com>
Date: Mon, 8 Jun 2020 12:13:38 -0700
Subject: [PATCH 7/8] u-boot: Work around the regression block accessing
 Recovery

PD#SWPL-26780

Problem:
Bootloader enable the stack-protection-strong check and block RDK Recovery.
New features are added to support RDK Reovery.
It's too late to adjust the memory map which will increase bootloader stack size.
Thereofore we will just patch it.

Solution:
Retore to no-stack-protector only for entering RDK Recovery

Verify:
u212/HP40A

Change-Id: I63ad409283fec8a18f5b02d950bc2808d9e73bcb
---
 Makefile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Makefile b/Makefile
index f54f2205b4..cd225bdd7c 100644
--- a/Makefile
+++ b/Makefile
@@ -556,7 +556,7 @@ ifdef BUILD_TAG
 KBUILD_CFLAGS += -DBUILD_TAG='"$(BUILD_TAG)"'
 endif
 
-STACK_CFLAGS  := $(call cc-option,-fstack-protector-strong)
+STACK_CFLAGS  := $(call cc-option,-fno-stack-protector)
 KBUILD_CFLAGS += $(STACK_CFLAGS)
 
 KBUILD_CFLAGS	+= -g
-- 
2.17.1

