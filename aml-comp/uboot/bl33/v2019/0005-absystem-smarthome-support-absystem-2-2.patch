From 4277c90bb3c7d2300050dd624c8815c8ae3c08fc Mon Sep 17 00:00:00 2001
From: "haotian.qu" <haotian.qu@amlogic.com>
Date: Fri, 17 Nov 2023 19:00:44 +0800
Subject: [PATCH 5/5] absystem: smarthome support absystem  [2/2]

PD#SWPL-145575

Problem:

Solution:

Verify:
local

Signed-off-by: haotian.qu <haotian.qu@amlogic.com>
Change-Id: Iaf18ca9fb36c87d6d76133ebee8a99163ba11774
---
 include/amlogic/base_env.h | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/include/amlogic/base_env.h b/include/amlogic/base_env.h
index 81d85922a9e..0eef3283622 100644
--- a/include/amlogic/base_env.h
+++ b/include/amlogic/base_env.h
@@ -31,6 +31,12 @@
 #define CONFIG_DTB_LOAD  "imgread dtb _aml_dtb ${dtb_mem_addr}"
 #endif//#ifdef CONFIG_DTB_BIND_KERNEL	//load dtb from kernel, such as boot partition
 
+#ifdef CONFIG_AB_SYSTEM
+#define CINFIG_KNL_READ "if imgread kernel ${recovery_part} ${loadaddr}; then bootm ${loadaddr}; fi;"
+#else
+#define CINFIG_KNL_READ "if imgread kernel ${boot_part} ${loadaddr}; then bootm ${loadaddr}; fi;"
+#endif
+
 #ifndef CONFIG_AML_PRODUCT_MODE
 #define _AML_RUN_UPDATE_ENV  \
 	/*first usb burning, second sdc_burn, third ext-sd autoscr/recovery*/\
@@ -185,7 +191,7 @@
 			"recovery_part=${recovery_part} recovery_offset=${recovery_offset};"\
 			"setenv bootconfig ${bootconfig} "\
 			"androidboot.slot_suffix=${active_slot};"\
-			"if imgread kernel ${boot_part} ${loadaddr}; then bootm ${loadaddr}; fi;"\
+			CINFIG_KNL_READ \
 			"else "\
 				"if test ${vendor_boot_mode} = true; then "\
 				"setenv bootargs ${bootargs} ${fs_type} aml_dt=${aml_dt};"\
